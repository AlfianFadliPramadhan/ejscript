#!/bin/sh
#
#   configure -- Configure for building
#
MIN_BIT=0.8.0
NAME=ejs
OS=`uname | sed 's/CYGWIN.*/windows/;s/Darwin/macosx/' | tr '[A-Z]' '[a-z]'`
PROFILE=debug
EXT=mk

if ! type bit >/dev/null 2>&1 ; then
    echo "" >&2
    echo "The \"bit\" tool is not installed. You can continue with a default build" >&2
    echo "by using \"make\". The default configuration can be tailored by setting" >&2
    echo "CFLAGS for the values in projects/${NAME}-${OS}-${PROFILE}-bit.h when running" >&2
    echo "make. For example, to disable CGI:" >&2
    echo "" >&2
    echo "	CFLAGS=-DBIT_PACK_CGI=0 make" >&2
    echo "" >&2
    echo "Alternatively, for faster, easier building, install the \"bit\" tool from" >&2
    echo "  http://embedthis.com/downloads/bit/download.ejs" >&2
    echo "" >&2
    exit 0
fi

ver=`(echo $MIN_BIT ; bit -V) | sort -r | head -n 1`
if [ "${MIN_BIT}" = "${ver}" ] ; then
    echo Please upgrade \"bit\" to $MIN_BIT
    exit 255
fi
if [ -f start.bit ] ; then
    bit clean >/dev/null 2>&1
fi
bit configure "$@"
