<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
   <title>Class Controller</title>

   <link rel="stylesheet" type="text/css" href="doc.css" />
</head>

<body>
<div class='body'>

<div class="content">

<a name='top'></a>
<h1 class='className'>Controller</h1>
<div class='classBlock'>
<table class='classHead' summary='Controller'>
   <tr><td><strong>Module</strong></td><td>ejs.web</td></tr>
   <tr><td><strong>Definition</strong></td><td> class Controller</td></tr>
   <tr><td><strong>Inheritance</strong></td><td>Controller <img src='images/inherit.gif' alt='inherit'/> <a href='ejs-Object.html'>Object</a>       </td></tr>
</table>

<p class='classBrief'>Create and initialize a controller.</p>

<p class='classDescription'>This may be called directly by class constructors or via 
the Controller.create factory method.</p>

</div>


<hr />
<a name='Properties'></a>
<h2 class='classSection'>Properties</h2>
<table class='itemTable' summary='properties'>
   <tr><th>Qualifiers</th><th>Property</th><th>Type</th><th width='95%'>Description</th></tr>
<a name='actionName'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>actionName</td><td><a href='ejs-String.html'>String</a></td><td>Name of the action being run. </td></tr>
<a name='config'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>config</td><td><a href='ejs-Object.html'>Object</a></td><td>Configuration settings - reference to Request.config. </td></tr>
<a name='controllerName'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>controllerName</td><td><a href='ejs-String.html'>String</a></td><td>Lower case controller name. </td></tr>
<a name='deploymentMode'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>deploymentMode</td><td><a href='ejs-String.html'>String</a></td><td>Deployment mode: debug, test, production. </td></tr>
<a name='flash'></a>
   <tr><td nowrap align='center'>public </td><td>flash</td><td><a href='ejs-Object.html'>Object</a></td><td>Flash messages to display on the next screen
"error"         Negative errors (Warnings and errors)
"inform"        Informational / postitive feedback (note)
"warn"          Negative feedback (Warnings and errors)
"*""             Other feedback (reminders, suggestions...). </td></tr>
<a name='log'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>log</td><td><a href='ejs-Logger.html'>Logger</a></td><td>Logger stream - reference to Request.log. </td></tr>
<a name='params'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>params</td><td><a href='ejs-Object.html'>Object</a></td><td>Form and query parameters - reference to the Request.params object. </td></tr>
<a name='rendered'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>rendered</td><td><a href='ejs-Boolean.html'>Boolean</a></td><td>The response has been rendered. If an action does not render a response, then a default view will be rendered.</td></tr>
<a name='request'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>request</td><td><a href='ejs.web-Request.html'>Request</a></td><td>Reference to the current Request object. </td></tr>
<a name='view'></a>
   <tr><td nowrap align='center'>ejs.web </td><td>view</td><td><a href='ejs.web-View.html'>View</a></td><td>Reference to the current View object. </td></tr>
<a name='absHome'></a>
   <tr><td nowrap align='left'>ejs.web const get </td><td>absHome</td><td><a href='ejs-Uri.html'>Uri</a></td><td> </td></tr>
<a name='home'></a>
   <tr><td nowrap align='left'>ejs.web const get </td><td>home</td><td><a href='ejs-Uri.html'>Uri</a></td><td> </td></tr>
<a name='pathInfo'></a>
   <tr><td nowrap align='left'>ejs.web const get </td><td>pathInfo</td><td><a href='ejs-String.html'>String</a></td><td> </td></tr>
<a name='session'></a>
   <tr><td nowrap align='left'>ejs.web const get </td><td>session</td><td><a href='ejs.web-Session.html'>Session</a></td><td> </td></tr>
<a name='uri'></a>
   <tr><td nowrap align='left'>ejs.web const get </td><td>uri</td><td><a href='ejs-Uri.html'>Uri</a></td><td> </td></tr>
</table>

<p class='inheritedLink'><a href='ejs-Object.html#Properties'><i>Inherited Properties</i></a></p>

<hr />
<a name='Methods'></a>
<h2 class='classSection'>Controller Methods</h2>
<table class='apiIndex' summary='methods'>
   <tr><th>Qualifiers</th><th width='95%'>Method</th></tr>
   <tr class='apiDef'><td class='apiType'>static const </td><td><a href='#create'><b>create</b></a>(request: <a href='ejs.web-Request.html'>Request</a>): <a href='ejs.web-Controller.html'>Controller</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Factory method to create and initialize a controller.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#error'><b>error</b></a>(msg: <a href='ejs-String.html'>String</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Send an error notification to the user.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#header'><b>header</b></a>(key: <a href='ejs-String.html'>String</a>): <a href='ejs-String.html'>String</a></tr><tr class='apiBrief'><td>&nbsp;</td><td></td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#inform'><b>inform</b></a>(msg: <a href='ejs-String.html'>String</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Send a positive notification to the user.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#makeUri'><b>makeUri</b></a>(location: <a href='ejs-Object.html'>Object</a>): <a href='ejs-Uri.html'>Uri</a></tr><tr class='apiBrief'><td>&nbsp;</td><td></td></tr>
   <tr class='apiDef'><td class='apiType'>action const </td><td><a href='#missing'><b>missing</b></a>(): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Missing action method.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#observe'><b>observe</b></a>(name, observer: <a href='ejs-Function.html'>Function</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td></td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#read'><b>read</b></a>(buffer: <a href='ejs-ByteArray.html'>ByteArray</a>, offset: <a href='ejs-Number.html'>Number</a> = 0 , count: <a href='ejs-Number.html'>Number</a> = -1): <a href='ejs-Number.html'>Number</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Read a data from the stream.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#redirect'><b>redirect</b></a>(where: <a href='ejs-Object.html'>Object</a>, status: <a href='ejs-Number.html'>Number</a> = expression): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Redirect the client to the given URL.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#redirectAction'><b>redirectAction</b></a>(action: <a href='ejs-String.html'>String</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Redirect the client to the given action.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#render'><b>render</b></a>(args: <a href='ejs-Array.html'>Array</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Render the raw arguments back to the client.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#renderError'><b>renderError</b></a>(status: <a href='ejs-Number.html'>Number</a>, msgs: <a href='ejs-Array.html'>Array</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Render an error message as the response.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#renderFile'><b>renderFile</b></a>(filename: <a href='ejs-Path.html'>Path</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Render a file's contents.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#renderPartial'><b>renderPartial</b></a>(path: <a href='ejs-Path.html'>Path</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Render a partial ejs template.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#renderView'><b>renderView</b></a>(viewName: <a href='ejs-String.html'>String</a> = null): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Render a view template.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#run'><b>run</b></a>(request: <a href='ejs.web-Request.html'>Request</a>): <a href='ejs-Object.html'>Object</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Run the controller action.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#setHeader'><b>setHeader</b></a>(key: <a href='ejs-String.html'>String</a>, value: <a href='ejs-String.html'>String</a>, overwrite: <a href='ejs-Boolean.html'>Boolean</a> = true): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td></td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#setStatus'><b>setStatus</b></a>(status: <a href='ejs-Number.html'>Number</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td></td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#warn'><b>warn</b></a>(msg: <a href='ejs-String.html'>String</a>): <a href='ejs-Void.html'>Void</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Send a warning message back to the client for display in the flash area.</td></tr>
   <tr class='apiDef'><td class='apiType'>const </td><td><a href='#write'><b>write</b></a>(data: <a href='ejs-Array.html'>Array</a>): <a href='ejs-Number.html'>Number</a></tr><tr class='apiBrief'><td>&nbsp;</td><td>Low-level write data to the client.</td></tr>
</table>

<p class='inheritedLink'><a href='ejs-Object.html#Methods'><i>Inherited Methods</i></a></p>

<hr />
<h2>Method Detail</h2>
<a name='create'></a>
<div class='api'>
<div class='apiSig'>static const  create(request: <a href='ejs.web-Request.html'>Request</a>): <a href='ejs.web-Controller.html'>Controller</a>
</div>
<div class='apiDetail'>
<p>Factory method to create and initialize a controller.</p>
<dl><dt>Description</dt><dd>The controller class is specified by 
params["controller"] which should be set by the router to the controller name without the "Controller" suffix. 
This call expects the controller class to be loaded. Called by Mvc.load().</dd></dl>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>request: <a href='ejs.web-Request.html'>Request</a> </td><td>Web request object.</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='error'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  error(msg: <a href='ejs-String.html'>String</a>): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Send an error notification to the user.</p>
<dl><dt>Description</dt><dd>This is just a convenience instead of setting flash["error"].</dd></dl>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>msg: <a href='ejs-String.html'>String</a> </td><td>Message to display.</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='inform'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  inform(msg: <a href='ejs-String.html'>String</a>): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Send a positive notification to the user.</p>
<dl><dt>Description</dt><dd>This is just a convenience instead of setting flash["inform"].</dd></dl>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>msg: <a href='ejs-String.html'>String</a> </td><td>Message to display.</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='missing'></a>
<div class='api'>
<div class='apiSig'>const   action  missing(): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Missing action method.</p>
<dl><dt>Description</dt><dd>This method will be called if the requested action routine does not exist.</dd></dl>
</div>
</div>
<hr />
<a name='read'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  read(buffer: <a href='ejs-ByteArray.html'>ByteArray</a>, offset: <a href='ejs-Number.html'>Number</a> = 0 , count: <a href='ejs-Number.html'>Number</a> = -1): <a href='ejs-Number.html'>Number</a>
</div>
<div class='apiDetail'>
<p>Read a data from the stream.</p>
<dl><dt>Description</dt><dd>If data is available, the call will return immediately. 
If no data is available and the stream is in sync mode, the call will block until data is available.
If no data is available and the stream is in async mode, the call will not block and will return immediately.
In this case a "readable" event will be issued when data is available for reading.</dd></dl>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>buffer: <a href='ejs-ByteArray.html'>ByteArray</a> </td><td>Destination byte array for read data.</td></tr><tr class='param'><td class='param'>offset: <a href='ejs-Number.html'>Number</a> </td><td>Offset in the byte array to place the data. If the offset is -1, then data is appended to the buffer write <a href='#position'>position</a> which is then updated [default: 0 ]</td></tr><tr class='param'><td class='param'>count: <a href='ejs-Number.html'>Number</a> </td><td>Read up to this number of bytes. If -1, read as much as the buffer will hold up. If the  stream is of fixed and known length (such as a file) and the buffer is of sufficient size or is growable,  read the entire stream. [default: -1]</td></tr><tr class='param'><td class='param'>offset: <a href='ejs-Number.html'>Number</a> </td><td> [default: 0 ]</td></tr><tr class='param'><td class='param'>count: <a href='ejs-Number.html'>Number</a> </td><td> [default: -1]</td></tr></table></dd>
</dl><dl><dt>Events</dt>
<dd><table class='parameters' summary ='events'>
<td class='param'>readable</td><td>Issued when there is new read data available.</td></tr>
<td class='param'>writable</td><td>Issued when the stream becomes empty.</td></tr>
</table></dd>
</dl><dl><dt>Returns</dt>
<dd>A count of the bytes actually read. Returns null on eof.</dd></dl>
</div>
</div>
<hr />
<a name='redirect'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  redirect(where: <a href='ejs-Object.html'>Object</a>, status: <a href='ejs-Number.html'>Number</a> = expression): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Redirect the client to the given URL.</p>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>where: <a href='ejs-Object.html'>Object</a> </td><td>Url to redirect the client toward. This can be a relative or absolute string URL or it can be a hash of URL components. For example, the following are valid inputs: "../index.ejs",  "http://www.example.com/home.html", {action: "list"}.</td></tr><tr class='param'><td class='param'>status: <a href='ejs-Number.html'>Number</a> </td><td>Http status code to use in the redirection response. Defaults to 302. [default: expression]</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='redirectAction'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  redirectAction(action: <a href='ejs-String.html'>String</a>): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Redirect the client to the given action.</p>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>action: <a href='ejs-String.html'>String</a> </td><td>Controller action name to which to redirect the client.</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='render'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  render(args: <a href='ejs-Array.html'>Array</a>): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Render the raw arguments back to the client.</p>
<dl><dt>Description</dt><dd>The args are converted to strings.</dd></dl>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>args: <a href='ejs-Array.html'>Array</a> </td><td>Arguments to write to the client.</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='renderError'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  renderError(status: <a href='ejs-Number.html'>Number</a>, msgs: <a href='ejs-Array.html'>Array</a>): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Render an error message as the response.</p>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>status: <a href='ejs-Number.html'>Number</a> </td><td>Http status code to use.</td></tr><tr class='param'><td class='param'>msgs: <a href='ejs-Array.html'>Array</a> </td><td>Error messages to send with the response.</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='renderFile'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  renderFile(filename: <a href='ejs-Path.html'>Path</a>): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Render a file's contents.</p>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>filename: <a href='ejs-Path.html'>Path</a> </td><td>Path to the filename to send to the client.</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='renderPartial'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  renderPartial(path: <a href='ejs-Path.html'>Path</a>): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Render a partial ejs template.</p>
<dl><dt>Description</dt><dd>Does not set "rendered" to true.</dd></dl>
</div>
</div>
<hr />
<a name='renderView'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  renderView(viewName: <a href='ejs-String.html'>String</a> = null): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Render a view template.</p>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>viewName: <a href='ejs-String.html'>String</a> </td><td> [default: null]</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='run'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  run(request: <a href='ejs.web-Request.html'>Request</a>): <a href='ejs-Object.html'>Object</a>
</div>
<div class='apiDetail'>
<p>Run the controller action.</p>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>request: <a href='ejs.web-Request.html'>Request</a> </td><td>Request object.</td></tr></table></dd>
</dl><dl><dt>Returns</dt>
<dd>A response object hash {status, headers, body} or null if writing directly using the request object.</dd></dl>
</div>
</div>
<hr />
<a name='warn'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  warn(msg: <a href='ejs-String.html'>String</a>): <a href='ejs-Void.html'>Void</a>
</div>
<div class='apiDetail'>
<p>Send a warning message back to the client for display in the flash area.</p>
<dl><dt>Description</dt><dd>This is just a convenience instead of
setting flash["warn"].</dd></dl>
<dl><dt>Parameters</dt>
<dd><table class='parameters' summary ='parameters'>
<tr class='param'><td class='param'>msg: <a href='ejs-String.html'>String</a> </td><td>Message to display.</td></tr></table></dd>
</dl></div>
</div>
<hr />
<a name='write'></a>
<div class='api'>
<div class='apiSig'>const   ejs.web  write(data: <a href='ejs-Array.html'>Array</a>): <a href='ejs-Number.html'>Number</a>
</div>
<div class='apiDetail'>
<p>Low-level write data to the client.</p>
<dl><dt>Description</dt><dd>This will buffer the written data until either flush() or 
finalize() is called.  This will not set the <a href='#rendered'>rendered</a> property.</dd></dl>
</div>
</div>
<hr />
<div class="terms">
   <p class="terms">
       <a href="http://www.embedthis.com/">       Embedthis Software LLC, 2003-2010. All rights reserved. Embedthis is a trademark of Embedthis Software LLC.</a>
   </p>
</div></div>
</div>
</body>
</html>
